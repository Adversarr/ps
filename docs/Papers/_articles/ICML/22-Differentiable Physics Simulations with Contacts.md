---
paperSource: ICML
paperAuthor: "Yaofeng Desmond Zhong, Jiequn Han, Georgia Olympia Brikis"
paperYear: 2022
doi: abs/2207.05060v1
title: "Differentiable Physics Simulations with Contacts: Do They Have Correct Gradients w.r.t. Position, Velocity and Control?"
date: 2023-11-06
tags: 
  - Differentiable Simulation
  - Collision Handling
---

本研究探讨了可微分物理模拟中不同接触模型对位置、速度和控制的梯度计算的正确性，并通过比较模拟计算的梯度与解析梯度的结果，揭示了当前可微分模拟器的局限性，并为开发更可靠的物理模拟器提供了新的研究机会。

<!-- more -->

## Basic Information:

- Title: Differentiable Physics Simulations with Contacts: Do They Have Correct Gradients w.r.t. Position, Velocity and Control? (可微分物理模拟与接触：它们对位置、速度和控制的梯度是否正确？)
- Authors: Yaofeng Desmond Zhong, Jiequn Han, Georgia Olympia Brikis
- Affiliation: 1. Siemens Technology, 2. Flatiron Institute
- Keywords: differentiable physics simulation, contacts, gradients, position, velocity, control
- URLs: [Paper](https://arxiv.org/abs/2207.05060v1), [GitHub Code](https://github.com/DesmondZhong/diff_sim_grads)

## 论文简要 :

- 本研究探讨了可微分物理模拟中不同接触模型对位置、速度和控制的梯度计算的正确性，并通过比较模拟计算的梯度与解析梯度的结果，揭示了当前可微分模拟器的局限性，并为开发更可靠的物理模拟器提供了新的研究机会。

## 背景信息:

- 论文背景: 近年来，越来越多的工作集中在可微分物理模拟上，并产生了一系列开源项目，如Tiny Differentiable Simulator、Nimble Physics、diffTaichi、Brax、Warp、Dojo和Dif- fCoSim。通过使物理模拟器端到端可微分，我们可以进行基于梯度的优化和学习任务。
- 过去方案: 大多数可微分模拟器考虑物体之间的碰撞和接触，但它们使用不同的接触模型来实现可微分性。本文概述了四种不同的可微分接触模型 - 线性互补问题（LCP）、凸优化模型、柔顺模型和基于位置的动力学（PBD）。我们分析和比较了这些模型计算的梯度，并表明这些梯度并不总是正确的。
- 论文的Motivation: 本文旨在回答一个简单但重要的问题 - 这些可微分接触模型是否计算出了位置、速度和控制的正确梯度？我们在两个可以通过解析梯度得到闭式形式的示例上实现了不同类型的可微分模拟，并通过比较模拟计算的梯度与解析梯度，观察到并不是所有计算出的梯度都是正确的，并且不同开源实现计算出的梯度也不一致。我们的结果揭示了当前可微分模拟器的局限性，并为开发更可靠的物理模拟器提供了新的研究机会。

## 方法:

- a. 理论背景:
  - 本文讨论了可微分物理模拟在基于梯度的优化和学习任务中的应用以及不同可微分接触模型的比较和梯度的正确性评估。文章还提到了当前可微分模拟器的局限性，并为进一步研究开发更可靠的物理模拟器提供了机会。
- b. 技术路线:
  - 本文使用可微分物理模拟工具在涉及简单无摩擦碰撞的三个任务中计算梯度。作者将问题离散化，并使用步进函数根据动力学和碰撞计算下一个时间步的状态。他们将控制序列初始化为恒定力，并使用梯度下降优化控制序列。他们将可微分模拟器计算的梯度与分析梯度进行了比较，并发现只有基于位置约束动力学（PBD）的实现结果接近分析梯度。

## 结果:

- a. 详细的实验设置:
  - 作者进行了三个任务来研究带有接触的可微分物理模拟的性能。
  - 任务1关注不同实现计算的梯度的准确性。
  - 任务2涉及优化弹球的初始速度以击中目标。
  - 任务3探索使用可微分模拟学习最优控制序列。
  - 对于任务1，作者将分析梯度与不同实现计算的梯度进行了比较。他们发现实现了时间碰撞（TOI）的实现能够计算准确的梯度，而没有TOI的实现结果完全错误。
  - 对于符合模型，没有TOI的概念，并且不同实现计算的梯度甚至在相反方向也不匹配。
  - 对于任务2，作者优化了弹球的初始速度以击中目标。他们使用学习率为0.01进行了1000个梯度步骤，并发现所有实现都能成功地最小化损失并完成任务。然而，不同的实现导致不同的轨迹。
  - 对于任务3，作者研究了两个球碰撞的最优控制序列。他们将不同实现计算的损失梯度与初始位置、速度和控制的分析梯度进行了比较。结果显示，不同实现计算的梯度不一致，这对优化和最终轨迹产生了重要影响。
  - 作者还观察到迭代0时刻关于初始速度的梯度的符号可以指示实现最终会得到哪个解决方案。
  - TOI的存在影响了关于初始速度的梯度的符号，从而影响了优化和最终轨迹。
- b. 详细的实验结果:
  - 本文使用不同的可微分物理模拟器计算了三个任务中的梯度，并将其与分析梯度进行了比较。
  - 对于任务1，只有基于位置约束动力学（PBD）的实现结果接近分析梯度。
  - 对于任务2，所有实现都能成功地最小化损失并完成任务，但不同的实现导致不同的轨迹。
  - 对于任务3，不同实现计算的梯度不一致，这对优化和最终轨迹产生了重要影响。
  - 作者还观察到迭代0时刻关于初始速度的梯度的符号可以指示实现最终会得到哪个解决方案。
  - TOI的存在影响了关于初始速度的梯度的符号，从而影响了优化和最终轨迹。

# Note:

- 本总结源自于LLM的总结，请注意数据判别. Power by ChatPaper. End.