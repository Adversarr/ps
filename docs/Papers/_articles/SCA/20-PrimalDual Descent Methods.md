---
paperSource: SCA
paperAuthor: "M. Macklin, K. Erleben, M. Müller, N. Chentanez, S. Jeschke, T.Y. Kim"
paperYear: 2020
doi: "10.1111/cgf.14104"
title: "Primal/Dual Descent Methods for Dynamics"
date: 2023-11-04
tags: 
  - Differentiable Simulation
---

本文提出了一种新的预处理摩擦接触求解器，该求解器与现有的原始优化方法兼容，并且在与对偶方法相比时**生成了更好的接触力分布**，具有可微性，非常适合轨迹优化。通过从共同的变分观点推导出原始和对偶方法，并对两种方法进行了全面的数值分析，证明了该方法在刚体接触、可变形模拟和机器人操作等场景中的有效性。

<!-- more -->

# Note:

- 本总结源自于LLM的总结，请注意数据判别. Power by ChatPaper. End.

## Basic Information:

- Title: Primal/Dual Descent Methods for Dynamics (动力学的原始/对偶下降方法)
- Authors: M. Macklin, K. Erleben, M. Müller, N. Chentanez, S. Jeschke, T.Y. Kim
- Affiliation: NVIDIA, University of Copenhagen (作者所属机构：NVIDIA, University of Copenhagen)
- Keywords: contact, friction, numerical optimization, robotics (关键词：接触、摩擦、数值优化、机器人)
- URLs: [Paper](https://onlinelibrary.wiley.com/doi/10.1111/cgf.14104), [GitHub Code](github:)

## 论文简要 :

- 本文提出了一种新的预处理摩擦接触求解器，该求解器与现有的原始优化方法兼容，并且在与对偶方法相比时生成了更好的接触力分布，具有可微性，非常适合轨迹优化。通过从共同的变分观点推导出原始和对偶方法，并对两种方法进行了全面的数值分析，证明了该方法在刚体接触、可变形模拟和机器人操作等场景中的有效性。

## 背景信息:

- 论文背景: 隐式时间积分在计算机图形学和机器人学中非常流行，由于其鲁棒性和高效性。然而，隐式时间离散化通常会导致非线性方程组。为了解决这些离散化的运动方程，许多数值方法被提出，可以广泛归类为原始方法和对偶方法。原始方法是以系统自由度（位置、速度和作用力）为表达和求解的，而对偶方法则侧重于自由度之间的约束，并以拉格朗日乘子的形式求解。
- 过去方案: 在可变形模拟中，变分框架（如投影动力学）已被广泛采用，但在刚体模拟等接触丰富的场景中尚未得到应用。而对偶方法在这些场景中得到了广泛应用，但其接触力分布相对于原始方法来说并不理想。
- 论文的Motivation: 本文旨在研究动力学的原始和对偶形式之间的关系，并提出一种新的预处理摩擦接触求解器，该求解器与现有的原始优化方法兼容，并且在与对偶方法相比时生成了更好的接触力分布。此外，该方法具有可微性，非常适合轨迹优化。通过从共同的变分观点推导出原始和对偶方法，并对两种方法进行了全面的数值分析，证明了该方法在刚体接触、可变形模拟和机器人操作等场景中的有效性。

## 方法:

- a. 理论背景:
  - 本文作者在可变形和刚体模拟的背景下，研究了动力学的原始和对偶形式之间的关系。他们提出了一种新的预条件摩擦接触求解器，与现有的原始优化方法兼容，并且与互补性方法相竞争。作者从共同的变分观点导出了原始和对偶方法，并对两种方法的条件进行了全面的数值分析。所提出的接触动力学的原始模型是可微的，并且非常适合轨迹优化。作者在包括刚体接触、可变形模拟和机器人操纵的场景中演示了他们的方法。
- b. 技术路线:
  - 作者引入了一种隐式时间步进方案来解决他们方法中的优化问题。他们将该方案构建为离散变分优化问题，并讨论了用于解决该问题的原始和对偶数值方法的使用。他们还分析了两种方法的敏感性和相对优势。作者定义了广义系统坐标及其时间导数，并对系统进行重新参数化以简化推导。他们提出了运动的离散方程，并为优化问题定义了目标函数。他们讨论了使用梯度下降作为解决最小化问题的简单方法，并引入了一个预条件矩阵来改善收敛性。他们还讨论了使用二次势能，并为这些势能导出了Hessian矩阵和力雅可比矩阵。最后，他们介绍了对偶上升方法，并展示了它如何导致约束动力学方法，如扩展位置基动力学（XPBD）。

## 结果:

- a. 详细的实验设置:
  - 通过使用一个简单的双摆和一个质量比分别为10000:1和4096:1的接触场景，演示了原始和对偶方法对质量比的敏感性。
  - 使用两个由弹簧连接的质点进行了刚度比测试，刚度系数之间的比率变化为10000:1。
  - 使用由256k个刚体组成的颗粒材料和一个圆柱形重物进行了刚性堆积实验，创建了一个质量比为80000:1的场景。
  - 使用512个碗从一定高度落下进行了碗落实验，每个碗由1160个面的三角网格表示。
  - 通过悬挂一块由800个三角形建模的布料并从一定高度落下一个刚体，进行了布料模拟实验。
  - 使用机器人操纵任务进行了抓握稳定性测试，测量了摩擦刚度变化对抓握稳定性的影响。
  - 进行了可微性实验，优化涉及与两个表面的碰撞的轨迹，以找到一个起始冲量，使得弹跳球在t = 0.5s时击中目标。
- b. 详细的实验结果:
  - 表1提供了本文中示例的模拟统计数据和性能指标，包括原始和对偶下降方法的步数、迭代次数、接触次数和每帧平均毫秒数。

